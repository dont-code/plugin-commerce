(self.webpackChunkcommerce_tester=self.webpackChunkcommerce_tester||[]).push([[9471],{99471:(L,E,r)=>{r.r(E);var C=r(78940),e=r(30549),m=r(6169),f=r(57863),v=r(84774);function M(o,t){1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275element(1,"dontcode-sandbox-main"),e.\u0275\u0275elementEnd())}function I(o,t){1&o&&(e.\u0275\u0275elementStart(0,"div"),e.\u0275\u0275element(1,"router-outlet"),e.\u0275\u0275elementEnd())}class a extends m.BaseAppComponent{}a.\u0275fac=function(){let o;return function(n){return(o||(o=e.\u0275\u0275getInheritedFactory(a)))(n||a)}}(),a.\u0275cmp=e.\u0275\u0275defineComponent({type:a,selectors:[["dontcode-commerce-root"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:2,consts:[[4,"ngIf"]],template:function(t,n){1&t&&(e.\u0275\u0275template(0,M,2,0,"div",0),e.\u0275\u0275template(1,I,2,0,"div",0)),2&t&&(e.\u0275\u0275property("ngIf",n.mainTab()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!n.mainTab()))},dependencies:[f.NgIf,v.RouterOutlet,m.MainComponent]});var b=r(39694);var u=r(16602),y=r(62314),U=r(83609),_=r(92256),p=r(27022),h=r(24504),N=r(49162);function A(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"p"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"p"),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd()()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("Status: ",n.testResponse.status,""),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("Size: ",null==n.testResponse.body?null:n.testResponse.body.length,"")}}function P(o,t){if(1&o&&(e.\u0275\u0275elementStart(0,"div")(1,"p"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("Error: $",n.testError,"")}}class l{constructor(t,n){this.httpClient=t,this.ref=n,this.testUrl=null,this.testResponse=null,this.testError=null,this.subscription=new _.Subscription}tryUrl(){if(null!=this.testUrl){const t=new u.HttpHeaders({"Access-Control-Allow-Origin":"localhost:5001",Accept:"text/html"});this.subscription.add(this.httpClient.get("https://corsproxy.io/?"+encodeURIComponent(this.testUrl),{headers:t,observe:"response",responseType:"text"}).subscribe({next:n=>{this.testResponse=n,console.debug("Result for "+this.testUrl+":",this.testResponse),this.ref.markForCheck()},error:n=>{this.testError=n instanceof u.HttpErrorResponse?n.message:n.toString(),console.error("Error loading testUrl "+this.testUrl+":",n),this.ref.markForCheck()}}))}}ngOnDestroy(){this.subscription.unsubscribe()}}l.\u0275fac=function(t){return new(t||l)(e.\u0275\u0275directiveInject(u.HttpClient),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},l.\u0275cmp=e.\u0275\u0275defineComponent({type:l,selectors:[["dontcode-test-url"]],decls:11,vars:3,consts:[[1,"p-float-label"],["id","url-to-try","type","text","pInputText","","size","60",3,"ngModel","ngModelChange"],["for","url-to-try"],["pButton","","type","button","label","Try",3,"click"],[4,"ngIf"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"h1"),e.\u0275\u0275text(1,"Price Check url tester"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"span",0)(3,"input",1),e.\u0275\u0275listener("ngModelChange",function(D){return n.testUrl=D}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"label",2),e.\u0275\u0275text(5,"Url of the search query:"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"button",3),e.\u0275\u0275listener("click",function(){return n.tryUrl()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"p"),e.\u0275\u0275text(8,"Result:"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(9,A,5,2,"div",4),e.\u0275\u0275template(10,P,3,1,"div",4)),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("ngModel",n.testUrl),e.\u0275\u0275advance(6),e.\u0275\u0275property("ngIf",n.testResponse),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",n.testError))},dependencies:[f.NgIf,p.DefaultValueAccessor,p.NgControlStatus,p.NgModel,h.ButtonDirective,N.InputText]});var x=r(15861),S=r(30178),T=r(46346);function j(o,t){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"p"),e.\u0275\u0275text(2,"Price:"),e.\u0275\u0275element(3,"p-inputNumber",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&o){const n=e.\u0275\u0275nextContext();let s;e.\u0275\u0275advance(3),e.\u0275\u0275property("currency",null!==(s=null==n.price.cost?null:n.price.cost.currencyCode)&&void 0!==s?s:"")("ngModel",null==n.price.cost?null:n.price.cost.amount)}}function F(o,t){if(1&o&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275text(1,"Error: "),e.\u0275\u0275elementStart(2,"textarea",3),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&o){const n=e.\u0275\u0275nextContext();e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(n.displayableError())}}class c{constructor(t,n){this.priceFinder=t,this.ref=n,this.shopName="",this.productName="",this.price={},this.displayPrice=!1,this.priceError=null}checkPrice(){var t=this;return(0,x.Z)(function*(){t.price={nameInShop:t.productName,shop:t.shopName};try{const n=yield t.priceFinder.searchProducts(t.productName,t.shopName);if(0==n.length)throw new Error("No product found with name "+t.productName+" in the shop "+t.shopName);{t.price.idInShop=n[0].productId;const s=yield t.priceFinder.findPrice(t.price,t.shopName,"");t.priceError="",null!=s&&null!=s.cost?(t.price=s,t.displayPrice=!0,t.priceError=null):(t.displayPrice=!1,t.priceError="No Price found"),t.ref.markForCheck()}}catch(n){t.priceError=n.message??n,t.displayPrice=!0,t.price={inError:!0},t.ref.markForCheck()}})()}displayableError(){return JSON.stringify(this.priceError)}}c.\u0275fac=function(t){return new(t||c)(e.\u0275\u0275directiveInject(y.PriceFinderService),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},c.\u0275cmp=e.\u0275\u0275defineComponent({type:c,selectors:[["dontcode-test-scrapper"]],inputs:{shopName:"shopName",productName:"productName"},decls:6,vars:4,consts:[[3,"onClick"],[4,"ngIf"],["mode","currency",3,"currency","ngModel"],["cols","80","pInputTextarea",""]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"p"),e.\u0275\u0275text(1),e.\u0275\u0275elementStart(2,"p-button",0),e.\u0275\u0275listener("onClick",function(){return n.checkPrice()}),e.\u0275\u0275text(3,"Check Price"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(4,j,4,2,"ng-container",1),e.\u0275\u0275template(5,F,4,1,"ng-container",1)),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2("",n.productName," @ ",n.shopName," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",n.displayPrice),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null!==n.priceError))},dependencies:[f.NgIf,p.NgControlStatus,p.NgModel,h.Button,S.InputTextarea,T.InputNumber]});class d{constructor(){this.listOfTestComponents=new e.QueryList}checkAllPrices(){var t=this;return(0,x.Z)(function*(){for(const n of t.listOfTestComponents)yield n.checkPrice()})()}}d.\u0275fac=function(t){return new(t||d)},d.\u0275cmp=e.\u0275\u0275defineComponent({type:d,selectors:[["dontcode-test-scrappers"]],viewQuery:function(t,n){if(1&t&&e.\u0275\u0275viewQuery(c,5),2&t){let s;e.\u0275\u0275queryRefresh(s=e.\u0275\u0275loadQuery())&&(n.listOfTestComponents=s)}},decls:12,vars:0,consts:[[3,"onClick"],["productName","Chardon Marie","shopName","EasyParapharmacie"],["productName","Chardon Marie","shopName","NewPharma"],["productName","Chardon Marie","shopName","WebEcologie"],["productName","Chardon Marie","shopName","Onatera"],["productName","Apple Watch 8","shopName","Boulanger"],["productName","Apple Watch 8","shopName","Amazon"],["productName","Apple Watch 8","shopName","Fnac"],["productName","Apple Watch 8","shopName","Darty"],["productName","Apple Watch 8","shopName","CDiscount"],["productName","Lugat Bio","shopName","Maxicoffee"]],template:function(t,n){1&t&&(e.\u0275\u0275elementStart(0,"p-button",0),e.\u0275\u0275listener("onClick",function(){return n.checkAllPrices()}),e.\u0275\u0275text(1,"Check All Prices"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(2,"dontcode-test-scrapper",1)(3,"dontcode-test-scrapper",2)(4,"dontcode-test-scrapper",3)(5,"dontcode-test-scrapper",4)(6,"dontcode-test-scrapper",5)(7,"dontcode-test-scrapper",6)(8,"dontcode-test-scrapper",7)(9,"dontcode-test-scrapper",8)(10,"dontcode-test-scrapper",9)(11,"dontcode-test-scrapper",10))},dependencies:[h.Button,c]});var R=r(43303);const k=[{path:"testUrl",component:l},{path:"testScrappers",component:d}];class i{}i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.\u0275\u0275defineNgModule({type:i,bootstrap:[a]}),i.\u0275inj=e.\u0275\u0275defineInjector({providers:[{provide:m.SANDBOX_MENUS,useClass:class B{additionalMenus(){return[{label:"Test Scrappers",icon:"pi pi-server",routerLink:["testScrappers"]},{label:"Test Url",icon:"pi pi-question-circle",routerLink:["testUrl"]}]}}}],imports:[C.BrowserModule,b.BrowserAnimationsModule,u.HttpClientModule,v.RouterModule.forRoot(k,{enableTracing:!1,useHash:!0,initialNavigation:"enabledBlocking"}),p.FormsModule,h.ButtonModule,N.InputTextModule,U.PluginCommonModule.forRoot(),m.SandboxModule.forRoot({webSocketUrl:"",indexedDbName:"Commerce Plugin Tester",applicationName:"Commerce Plugin Tester",theme:"orange",templateFileUrl:"assets/dev/templates.json"}),R.FieldsModule,y.CommerceModule,S.InputTextareaModule,p.ReactiveFormsModule,T.InputNumberModule]}),(0,e.enableProdMode)(),C.platformBrowser().bootstrapModule(i).catch(o=>console.error(o))}}]);